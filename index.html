<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Financial Planner</title>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet"/>
<style>
        body { padding: 20px; }
        .toast-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
        }
        .hidden-section { display: none; }
        .menu-toggle { position: absolute; top: 20px; right: 20px; }
        .menu-dropdown { display: none; position: absolute; right: 20px; top: 60px; background: #fff; border: 1px solid #ccc; z-index: 1000; }
        .menu-dropdown.show { display: block; }
        .menu-dropdown a { display: block; padding: 10px 15px; text-decoration: none; color: #000; border-bottom: 1px solid #eee; }
        .menu-dropdown a:hover { background: #f8f9fa; }
        .dark-mode { background-color: #343a40; color: #f8f9fa; }
        .dark-mode .card { background-color: #495057; border-color: #6c757d; }
        .dark-mode .card-body { color: #f8f9fa; }
        .dark-mode input,
        .dark-mode select,
        .dark-mode .form-control,
        .dark-mode .form-control-file {
            background-color: #495057;
            color: #f8f9fa;
            border-color: #6c757d;
        }
        .dark-mode .btn {
            background-color: #6c757d;
            border-color: #6c757d;
            color: #f8f9fa;
        }
        .dark-mode .btn-primary { background-color: #007bff; border-color: #007bff; }
        .dark-mode .btn-secondary { background-color: #6c757d; border-color: #6c757d; }
        .dark-mode .btn-info { background-color: #17a2b8; border-color: #17a2b8; }
        .dark-mode .btn-light { background-color: #adb5bd; border-color: #adb5bd; color: #343a40; }
        .dark-mode .menu-dropdown { background: #495057; border-color: #6c757d; }
        .dark-mode .menu-dropdown a { color: #f8f9fa; border-bottom: 1px solid #6c757d; }
        .dark-mode .menu-dropdown a:hover { background-color: #6c757d; }
        .toast.slide-down {
            animation: slideDownFade 0.5s ease-out, fadeOut 0.5s ease-in 2.5s forwards;
        }
        @keyframes slideDownFade {
            0% { opacity: 0; transform: translateY(-20px); }
            10% { opacity: 1; transform: translateY(0); }
            90% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }
        @keyframes fadeOut {
            to { opacity: 0; visibility: hidden; }
        }
    
/* Mobile Enhancements */
@media (max-width: 576px) {
    .form-control, .btn {
        font-size: 1rem;
        padding: 0.75rem;
    }
    .form-group {
        margin-bottom: 1.2rem;
    }
    table {
        display: block;
        overflow-x: auto;
        width: 100%;
    }
    .btn {
        width: 100%;
    }
    #chart-container {
        height: 50vh !important;
    }
}
#chart-container {
    width: 100%;
    height: 60vh;
    overflow-x: auto;
}

/* Stronger Mobile Enhancements */
@media (max-width: 768px) {
    .form-inline {
        flex-direction: column !important;
        align-items: stretch !important;
    }
    .form-inline label,
    .form-inline input,
    .form-inline select,
    .form-inline button {
        width: 100% !important;
        margin-bottom: 0.75rem !important;
    }
    .form-control {
        font-size: 1.1rem !important;
        padding: 0.75rem 1rem !important;
    }
    .btn {
        font-size: 1.1rem !important;
        padding: 0.75rem 1rem !important;
        width: 100% !important;
    }
    #chart-container {
        height: 50vh !important;
    }
    table {
        display: block;
        overflow-x: auto;
        width: 100%;
    }
    th, td {
        white-space: nowrap;
    }
}

/* Improved Mobile Menu Design */
.menu-dropdown {
    min-width: 180px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    padding: 0;
}
.menu-dropdown a {
    font-size: 1.05rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 10px;
}
.menu-dropdown a i {
    width: 20px;
    text-align: center;
}
.menu-dropdown a:hover {
    background-color: #e9ecef !important;
    color: #000 !important;
}
@media (max-width: 576px) {
    .menu-dropdown a {
        padding: 12px 18px;
        font-size: 1.1rem;
    }
}

/* Enlarge button/menu icons for better mobile accessibility */
.menu-dropdown a i,
.btn i,
button i {
    font-size: 2.2rem !important;
    vertical-align: middle;
}

.menu-dropdown a span {
    vertical-align: middle;
}

/* Clean and balanced menu appearance */
.menu-dropdown {
    min-width: 200px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.15);
    padding: 0;
}
.menu-dropdown a {
    display: flex;
    align-items: center;
    padding: 16px 20px;
    font-size: 1.25rem;
    font-weight: 500;
    gap: 16px;
    border-bottom: 1px solid #eee;
}
.menu-dropdown a i {
    font-size: 1.6rem !important;
    width: 32px;
    text-align: center;
}
.menu-dropdown a span {
    font-size: 1.25rem;
    display: inline-block;
    margin-left: 0;
}
.menu-dropdown a:hover {
    background-color: #f0f0f0 !important;
    color: #000 !important;
}
@media (max-width: 576px) {
    .menu-dropdown a {
        padding: 18px 24px;
        font-size: 1.35rem;
    }
    .menu-dropdown a i {
        font-size: 1.8rem !important;
    }
    .menu-dropdown a span {
        font-size: 1.35rem;
    }
}

/* Doubled Size Menu Appearance */
.menu-dropdown {
    min-width: 240px;
    border-radius: 12px;
    box-shadow: 0 6px 16px rgba(0,0,0,0.18);
}
.menu-dropdown a {
    display: flex;
    align-items: center;
    padding: 24px 28px;
    font-size: 2rem;
    font-weight: 600;
    gap: 24px;
    border-bottom: 1px solid #ddd;
}
.menu-dropdown a i {
    font-size: 2.4rem !important;
    width: 40px;
    text-align: center;
}
.menu-dropdown a span {
    font-size: 2rem;
}
.menu-dropdown a:hover {
    background-color: #f1f1f1 !important;
    color: #000 !important;
}
@media (max-width: 576px) {
    .menu-dropdown a {
        padding: 26px 32px;
        font-size: 2.2rem;
    }
    .menu-dropdown a i {
        font-size: 2.6rem !important;
        width: 44px;
    }
    .menu-dropdown a span {
        font-size: 2.2rem;
    }
}

/* Global scaling of base UI */
body {
    font-size: 1.4rem;
    line-height: 1.8;
}
h1, h2, h3, h4 {
    font-size: 1.8rem;
    font-weight: 600;
}
.form-control {
    font-size: 1.4rem !important;
    padding: 0.9rem 1.2rem !important;
}
label {
    font-size: 1.3rem;
    font-weight: 500;
}
.table th, .table td {
    font-size: 1.3rem;
    vertical-align: middle;
}
.btn {
    font-size: 1.4rem !important;
    padding: 1rem 1.4rem !important;
}

/* Further enhanced global UI scaling */
body {
    font-size: 1.7rem;
    line-height: 2.1;
}
h1 {
    font-size: 2.4rem;
}
h2 {
    font-size: 2.2rem;
}
h3, h4 {
    font-size: 2rem;
}
.form-control {
    font-size: 1.7rem !important;
    padding: 1.1rem 1.4rem !important;
}
label {
    font-size: 1.6rem;
    font-weight: 600;
}
.table th, .table td {
    font-size: 1.6rem;
    vertical-align: middle;
}
.btn {
    font-size: 1.7rem !important;
    padding: 1.2rem 1.6rem !important;
}
#calculation-result {
    font-size: 1.8rem !important;
}

/* Refined and balanced UI scaling */
body {
    font-size: 1.5rem;
    line-height: 2;
}
h1 {
    font-size: 2.2rem;
}
h2 {
    font-size: 2rem;
}
h3, h4 {
    font-size: 1.8rem;
}
label {
    font-size: 1.4rem;
    font-weight: 500;
}
.form-control {
    font-size: 1.5rem !important;
    padding: 1rem 1.4rem !important;
}
.table th, .table td {
    font-size: 1.45rem;
    vertical-align: middle;
}
.btn {
    font-size: 1.5rem !important;
    padding: 1.1rem 1.6rem !important;
}
#calculation-result {
    font-size: 1.6rem !important;
}

/* Enlarge Plotly modebar buttons for mobile accessibility */
.js-plotly-plot .modebar {
    transform: scale(1.8);
    transform-origin: top right;
    right: 10px !important;
    top: 10px !important;
}

.card-body {
    font-size: 1.4rem;
    padding: 1.2rem;
}
.card-body p {
    margin-bottom: 0.6rem;
}
.card-body .btn {
    font-size: 1.3rem;
    padding: 0.7rem 1.2rem;
    width: 48%;
}
.card-body .btn-warning {
    background-color: #ffc107;
    color: black;
}
.card-body .btn-danger {
    background-color: #dc3545;
    color: white;
}

.card-body {
    font-size: 1.6rem;
}
.card-body h5 {
    font-size: 1.7rem;
    font-weight: bold;
}
.card-body .row > div {
    font-size: 1.5rem;
}
.card-body .btn {
    font-size: 1.5rem;
    padding: 0.9rem 1.4rem;
}

.modal-content {
    font-size: 1.8rem;
}
.modal-title {
    font-size: 2.2rem;
    font-weight: bold;
}
.modal-body label {
    font-size: 1.6rem;
}
.modal-body input, .modal-body select {
    font-size: 1.7rem !important;
    padding: 1.2rem !important;
}
.modal-footer .btn {
    font-size: 1.6rem;
    padding: 1rem 2rem;
}

.modal-content {
    font-size: 2rem;
}
.modal-title {
    font-size: 2.5rem;
    font-weight: bold;
}
.modal-body label {
    font-size: 2rem;
}
.modal-body input,
.modal-body select {
    font-size: 2rem !important;
    padding: 1.4rem !important;
    height: auto !important;
}
.modal-footer .btn {
    font-size: 2rem;
    padding: 1.2rem 2.2rem;
}
select.form-control {
    -webkit-appearance: menulist !important;
    appearance: menulist !important;
    background-color: white;
    color: black;
}

[id^="expense-group-"],
[id^="income-group-"] {
  display: block;
}
</style>
<script>
const incomes = JSON.parse(localStorage.getItem('incomes') || '[]');
const expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
</script><script src="https://cdn.plot.ly/plotly-latest.min.js"></script></head>
<body>
<div class="d-flex justify-content-between align-items-center mb-4">
<h1>Financial Planner</h1>
<div class="menu-toggle">
<button class="btn btn-light" id="menuButton"><i class="fas fa-bars"></i></button>
<div class="menu-dropdown" id="menuDropdown">
<a data-section="overview-section" href="#"><i class="fas fa-chart-line"></i><span>Financial Overview</span></a>
<a data-section="expenses-section" href="#"><i class="fas fa-wallet"></i><span>Expenses</span></a>
<a data-section="income-section" href="#"><i class="fas fa-hand-holding-usd"></i><span>Income</span></a>
<a data-section="settings-section" href="#"><i class="fas fa-cog"></i><span>Settings</span></a>
</div>
</div>
</div>
<div class="toast-container">
<div aria-atomic="true" aria-live="assertive" class="toast bg-info text-white" id="toastMessage" role="alert" style="display:none;">
<div class="toast-body">Balance updated successfully!</div>
</div>
</div>
<div class="main-section hidden-section" id="settings-section">
<div class="card mb-4">
<div class="card-body">
<h2>Account Settings</h2>
<form id="balance-form">
<div class="form-group">
<label for="starting-balance">Starting Balance:</label>
<input class="form-control" id="starting-balance" placeholder="0.00" required="" type="number"/>
</div>
<button class="btn btn-primary" type="submit">Set Balance</button>
</form>
</div>
</div>
<div class="card mb-4">
<div class="card-body"><h3 class="text-center mb-4">Data Management</h3><button class="btn btn-primary btn-lg btn-block mb-3" id="export-data">Export Data</button><label class="font-weight-bold" for="import-file">Import JSON File:</label><input class="form-control mb-2" id="import-file" type="file"/><button class="btn btn-success btn-lg btn-block" id="import-data">Import Data</button><p class="text-muted mt-2" style="font-size: 1.2rem;">Export your current data for backup or transfer. Import to restore saved records.</p></div>
</div>
<div class="card">
<div class="card-body">
<h4>Appearance</h4>
<button class="btn btn-light" id="darkModeToggle">
<span class="fas fa-moon" id="darkModeIcon"></span> Toggle Dark Mode
            </button>
</div>
</div>
</div>
<div class="main-section hidden-section" id="expenses-section">
<button class="btn btn-success btn-block mb-3" onclick="clearExpenseModal()">Add Expense</button><div class="card">
<div class="card-body">
<h2>Expenses</h2>
<form id="expense-form">
<div class="form-row align-items-end">
<div class="form-group col-md-3">
<label for="expense-description">Description</label>
</div>
<div class="form-group col-md-2">
<label for="expense-amount">Amount</label>
</div>
<div class="form-group col-md-2">
<label for="expense-date">Start Date</label>
</div>
<div class="form-group col-md-2">
<label for="expense-end-date">End Date (opt)</label>
</div>
<div class="form-group col-md-2">
<label for="expense-frequency">Frequency</label>
</div>
<div class="form-group col-md-1">
</div>
</div>
</form>
<div class="mb-4" id="expenses-cards"></div>
</div>
</div>
</div>
<div class="main-section hidden-section" id="income-section">
<button class="btn btn-success btn-block mb-3" onclick="clearIncomeModal()">Add Income</button><div class="card">
<div class="card-body">
<h2>Income</h2>
<form id="income-form">
<div class="form-row align-items-end">
<div class="form-group col-md-3">
<label for="income-description">Description</label>
</div>
<div class="form-group col-md-2">
<label for="income-amount">Amount</label>
</div>
<div class="form-group col-md-2">
<label for="income-date">Start Date</label>
</div>
<div class="form-group col-md-2">
<label for="income-end-date">End Date (opt)</label>
</div>
<div class="form-group col-md-2">
<label for="income-frequency">Frequency</label>
</div>
<div class="form-group col-md-1">
</div>
</div>
</form>
<div class="mb-4" id="income-cards"></div>
</div>
</div>
</div>
<div class="main-section" id="overview-section">
<div class="card">
<div class="card-body">
<form class="form-inline justify-content-center mb-3" id="calculate-form">
<label class="mr-2 font-weight-bold" for="target-date">Target Date:</label>
<input aria-label="Target date input for forecast" class="form-control" id="target-date" required="" style="width: 100%; font-size: 1.5rem; padding: 1rem;" title="Select your target date for financial forecast" type="date"/>
</form><div class="mt-4 text-center font-weight-bold h5" id="calculation-result"></div>
<form class="form-inline" id="chart-range-form">
<input class="form-control mb-2 mr-sm-2" id="chart-start-date" style="display:none;" type="date"/>
<input class="form-control mb-2 mr-sm-2" id="chart-end-date" style="display:none;" type="date"/>
</form>
<div id="chart-container" style="height: 70vh;"><div id="plotly-graph" style="width:100%; min-height:60vh; display:block;"></div></div>
</div>
</div>
</div>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script>
function calculateDailyNetAmount(date) {
    let dailyIncome = 0, dailyExpense = 0;

    incomes.forEach(income => {
        const start = new Date(income.date);
        const end = income.endDate ? new Date(income.endDate) : null;
        start.setHours(0,0,0,0);
        if (end) end.setHours(0,0,0,0);
        if (start <= date && (!end || date <= end)) {
            if (income.frequency === 'once' && date.getTime() === start.getTime()) dailyIncome += income.amount;
            else if (income.frequency === 'weekly' && Math.floor((date - start)/(1000*60*60*24)) % 7 === 0) dailyIncome += income.amount;
            else if (income.frequency === 'monthly' && date.getDate() === start.getDate()) dailyIncome += income.amount;
            else if (income.frequency === 'yearly' && date.getDate() === start.getDate() && date.getMonth() === start.getMonth()) dailyIncome += income.amount;
        }
    });

    expenses.forEach(expense => {
        const start = new Date(expense.date);
        const end = expense.endDate ? new Date(expense.endDate) : null;
        start.setHours(0,0,0,0);
        if (end) end.setHours(0,0,0,0);
        if (start <= date && (!end || date <= end)) {
            if (expense.frequency === 'once' && date.getTime() === start.getTime()) dailyExpense += expense.amount;
            else if (expense.frequency === 'weekly' && Math.floor((date - start)/(1000*60*60*24)) % 7 === 0) dailyExpense += expense.amount;
            else if (expense.frequency === 'monthly' && date.getDate() === start.getDate()) dailyExpense += expense.amount;
            else if (expense.frequency === 'yearly' && date.getDate() === start.getDate() && date.getMonth() === start.getMonth()) dailyExpense += expense.amount;
        }
    });

    return dailyIncome - dailyExpense;
}
</script><script>
function updateChart() {
    try {
        const labels = [], dataBalance = [];
        let startDate = new Date();
        let endDate = new Date(document.getElementById("target-date").value);

        startDate.setHours(0,0,0,0);
        endDate.setHours(0,0,0,0);

        let currentDate = new Date(startDate);
        let balance = parseFloat(localStorage.getItem("startingBalance") || 0);
        let lastBalance = balance;

        while (currentDate <= endDate) {
            balance += calculateDailyNetAmount(currentDate);
            if (balance !== lastBalance || labels.length === 0 || currentDate.getTime() === endDate.getTime()) {
                labels.push(currentDate.toISOString().split('T')[0]);
                dataBalance.push(balance);
                lastBalance = balance;
            }
            currentDate.setDate(currentDate.getDate() + 1);
        }

        const finalBalance = dataBalance[dataBalance.length - 1];
        const displayText = "Estimated Balance on " + endDate.toDateString() + ": " +
            finalBalance.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
        document.getElementById("calculation-result").innerHTML = "<p class='font-weight-bold'>" + displayText + "</p>";

        const layout = {
            title: "Balance Forecast",
            xaxis: { title: "Date", type: "date" },
            yaxis: { title: "Balance", tickprefix: "$" },
            margin: { t: 50, r: 20, l: 50, b: 50 },
            responsive: true
        };

        const trace = {
            x: labels,
            y: dataBalance,
            type: 'scatter',
            mode: 'lines+markers',
            line: { color: 'blue' },
            name: 'Balance'
        };

        



Plotly.newPlot("plotly-graph", [trace], layout, {
    responsive: true,
    displaylogo: false,
    modeBarButtonsToRemove: ["zoom2d", "pan2d", "autoScale2d", "select2d", "lasso2d", "toImage", "zoomIn2d", "zoomOut2d", "hoverClosestCartesian", "hoverCompareCartesian", "toggleSpikelines"],
    modeBarButtonsToKeep: ["resetScale2d"]
});




    } catch (e) {
        document.getElementById("calculation-result").innerHTML = "<p class='text-danger'>Chart rendering failed: " + e.message + "</p>";
    }
}
</script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script>
    const menuBtn = document.getElementById("menuButton");
    const menuDropdown = document.getElementById("menuDropdown");
    const mainSections = document.querySelectorAll(".main-section");
    const toastMessage = document.getElementById("toastMessage");
    let currentSection = document.querySelector(".main-section:not(.hidden-section)") || mainSections[0];

    menuBtn.addEventListener("click", () => {
        menuDropdown.classList.toggle("show");
    });

    menuDropdown.querySelectorAll("a").forEach(link => {
        link.addEventListener("click", e => {
            e.preventDefault();
            const sectionId = e.target.getAttribute("data-section");
            const newSection = document.getElementById(sectionId);
            if (currentSection !== newSection) {
                currentSection.classList.add("hidden-section");
                newSection.classList.remove("hidden-section");
                currentSection = newSection;
                if (sectionId === "overview-section") updateChart();
            }
            menuDropdown.classList.remove("show");
        });
    });

    const darkToggle = document.getElementById("darkModeToggle");
    const darkIcon = document.getElementById("darkModeIcon");

    darkToggle.addEventListener("click", () => {
        document.body.classList.toggle("dark-mode");
        if (document.body.classList.contains("dark-mode")) {
            localStorage.setItem("darkMode", "enabled");
            darkIcon.classList.remove("fa-moon");
            darkIcon.classList.add("fa-sun");
        } else {
            localStorage.setItem("darkMode", "disabled");
            darkIcon.classList.remove("fa-sun");
            darkIcon.classList.add("fa-moon");
        }
    });

    if (localStorage.getItem("darkMode") === "enabled") {
        document.body.classList.add("dark-mode");
        darkIcon.classList.remove("fa-moon");
        darkIcon.classList.add("fa-sun");
    }

    const savedBalance = localStorage.getItem("startingBalance");
    if (savedBalance !== null && !isNaN(savedBalance)) {
        document.getElementById("starting-balance").value = parseFloat(savedBalance);
    }

    const balanceForm = document.getElementById("balance-form");
    balanceForm.addEventListener("submit", function(e) {
        e.preventDefault();
        const balanceValue = parseFloat(document.getElementById("starting-balance").value);
        if (!isNaN(balanceValue)) {
            const roundedBalance = Math.round(balanceValue * 100) / 100;
            localStorage.setItem("startingBalance", roundedBalance);
            requestAnimationFrame(() => {
                toastMessage.classList.remove("slide-down");
                toastMessage.offsetHeight;
                toastMessage.classList.add("slide-down");
                toastMessage.style.display = "block";
            });
        }
    });
    document.getElementById("export-data").addEventListener("click", function () {
        const data = {
            expenses,
            incomes,
            startingBalance: parseFloat(localStorage.getItem("startingBalance") || 0)
        };
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(data));
        const downloadAnchorNode = document.createElement("a");
        downloadAnchorNode.setAttribute("href", dataStr);
        downloadAnchorNode.setAttribute("download", "financial_data.json");
        document.body.appendChild(downloadAnchorNode);
        downloadAnchorNode.click();
        downloadAnchorNode.remove();
    });

    document.getElementById("import-data").addEventListener("click", function () {
        const fileInput = document.getElementById("import-file");
        if (fileInput.files.length === 0) {
            alert("Please select a file to import.");
            return;
        }
        const file = fileInput.files[0];
        const reader = new FileReader();

        reader.onload = function (e) {
            try {
                const importedData = JSON.parse(e.target.result);

                const loadedExpenses = importedData.expenses || [];
                const loadedIncomes = importedData.incomes || [];
                const loadedStartingBalance = importedData.startingBalance || 0;

                expenses.length = 0;
                incomes.length = 0;

                expenses.push(...loadedExpenses.map(exp => ({
                    description: exp.description,
                    amount: exp.amount,
                    frequency: exp.frequency,
                    date: exp.date,
                    endDate: exp.endDate ?? ""
                })));

                incomes.push(...loadedIncomes.map(inc => ({
                    description: inc.description,
                    amount: inc.amount,
                    frequency: inc.frequency,
                    date: inc.date,
                    endDate: inc.endDate ?? ""
                })));

                localStorage.setItem("startingBalance", loadedStartingBalance);
                localStorage.setItem("expenses", JSON.stringify(expenses));
                localStorage.setItem("incomes", JSON.stringify(incomes));

                document.getElementById("starting-balance").value = loadedStartingBalance;
                renderExpenses();
                renderIncomes();
                alert("Data imported successfully.");
            } catch (err) {
                alert("Import failed: " + err.message);
            }
        };

        reader.readAsText(file);
    });
    window.addEventListener("load", () => {

        const today = new Date();
        const endOfYear = new Date(today.getFullYear() + 1, today.getMonth(), today.getDate());
        document.getElementById("target-date").value = endOfYear.toISOString().split("T")[0];
        updateChart();
        
        updateChart();
    });
</script>
<script>
document.getElementById("chart-start-date").addEventListener("input", updateChart);
document.getElementById("chart-end-date").addEventListener("input", updateChart);
</script>
<script>
  document.querySelectorAll('#menuDropdown a').forEach(link => {
    link.onclick = function(e) {
      e.preventDefault();
      const sectionId = this.getAttribute('data-section');
      document.querySelectorAll('.main-section').forEach(sec => sec.classList.add('hidden-section'));
      document.getElementById(sectionId).classList.remove('hidden-section');
      document.getElementById('menuDropdown').classList.remove('show');
      if (sectionId === 'overview-section') updateChart();
    };
  });
</script>
<script>document.getElementById("target-date").addEventListener("input", updateChart);</script><script>
function renderExpensesUpdated() {
    const expenseTableBody = document.querySelector("#expenses-table tbody");
    const expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
    expenseTableBody.innerHTML = "";
    expenses.forEach((item, index) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${item.description}</td>
            <td>${item.amount.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}</td>
            <td>${item.date}</td>
            <td>${item.endDate || ''}</td>
            <td>${item.frequency}</td>
            <td>
              <button class="btn btn-sm btn-warning" onclick="editExpense(${index})">Edit</button>
              <button class="btn btn-sm btn-danger" onclick="deleteExpense(${index})">Delete</button>
            </td>`;
        expenseTableBody.appendChild(tr);
    });
}

function renderExpensesUpdated() {
    const expenseCardsContainer = document.getElementById("expenses-cards");
    const expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
    expenseCardsContainer.innerHTML = "";
    expenses.forEach((item, index) => {
        const card = document.createElement("div");
        card.className = "card mb-2 shadow-sm";
        card.innerHTML = `
            <div class="card-body">
                <h5 class="card-title font-weight-bold">${item.description}</h5>
                <div class="row">
                    <div class="col-6"><strong>Amount:</strong> $${item.amount.toFixed(2)}</div>
                    <div class="col-6"><strong>Frequency:</strong> ${item.frequency}</div>
                </div>
                <div class="row">
                    <div class="col-6"><strong>Start:</strong> ${item.date}</div>
                    <div class="col-6"><strong>End:</strong> ${item.endDate || "-"}</div>
                </div>
                <div class="d-flex justify-content-between mt-2">
                    <button class="btn btn-warning btn-sm" onclick="editExpense(${index})">Edit</button>
                    <button class="btn btn-danger btn-sm" onclick="deleteExpense(${index})">Delete</button>
                </div>
            </div>`;
        expenseCardsContainer.appendChild(card);
    });
}
window.renderExpenses = renderExpensesUpdated;
</script><script>
function renderIncomesUpdated() {
    const incomeTableBody = document.querySelector("#income-table tbody");
    const incomes = JSON.parse(localStorage.getItem('incomes') || '[]');
    incomeTableBody.innerHTML = "";
    incomes.forEach((item, index) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${item.description}</td>
            <td>${item.amount.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}</td>
            <td>${item.date}</td>
            <td>${item.endDate || ''}</td>
            <td>${item.frequency}</td>
            <td>
              <button class="btn btn-sm btn-warning" onclick="editIncome(${index})">Edit</button>
              <button class="btn btn-sm btn-danger" onclick="deleteIncome(${index})">Delete</button>
            </td>`;
        incomeTableBody.appendChild(tr);
    });
}

function renderIncomesUpdated() {
    const incomeCardsContainer = document.getElementById("income-cards");
    const incomes = JSON.parse(localStorage.getItem("incomes") || "[]");
    incomeCardsContainer.innerHTML = "";
    incomes.forEach((item, index) => {
        const card = document.createElement("div");
        card.className = "card mb-2 shadow-sm";
        card.innerHTML = `
            <div class="card-body">
                <h5 class="card-title font-weight-bold">${item.description}</h5>
                <div class="row">
                    <div class="col-6"><strong>Amount:</strong> $${item.amount.toFixed(2)}</div>
                    <div class="col-6"><strong>Frequency:</strong> ${item.frequency}</div>
                </div>
                <div class="row">
                    <div class="col-6"><strong>Start:</strong> ${item.date}</div>
                    <div class="col-6"><strong>End:</strong> ${item.endDate || "-"}</div>
                </div>
                <div class="d-flex justify-content-between mt-2">
                    <button class="btn btn-warning btn-sm" onclick="editIncome(${index})">Edit</button>
                    <button class="btn btn-danger btn-sm" onclick="deleteIncome(${index})">Delete</button>
                </div>
            </div>`;
        incomeCardsContainer.appendChild(card);
    });
}
window.renderIncomes = renderIncomesUpdated;
</script><script>window.addEventListener('load', function() { renderExpenses(); renderIncomes(); });</script><script>
function renderExpensesUpdated() {
    const expenseCardsContainer = document.getElementById("expenses-cards");
    const expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
    expenseCardsContainer.innerHTML = "";
    expenses.forEach((item, index) => {
        const card = document.createElement("div");
        card.className = "card mb-2 shadow-sm";
        card.innerHTML = `
            <div class="card-body">
                <h5 class="card-title">${item.description}</h5>
                <p class="card-text">
                    <strong>Amount:</strong> $${item.amount.toFixed(2)}<br>
                    <strong>Start:</strong> ${item.date}<br>
                    <strong>End:</strong> ${item.endDate || "-"}<br>
                    <strong>Frequency:</strong> ${item.frequency}
                </p>
                <div class="d-flex justify-content-between">
                    <button class="btn btn-warning btn-sm" onclick="editExpense(${index})">Edit</button>
                    <button class="btn btn-danger btn-sm" onclick="deleteExpense(${index})">Delete</button>
                </div>
            </div>`;
        expenseCardsContainer.appendChild(card);
    });
}

function renderIncomes() {
    const incomeCardsContainer = document.getElementById("income-cards");
    const incomes = JSON.parse(localStorage.getItem("incomes") || "[]");
    incomeCardsContainer.innerHTML = "";
    incomes.forEach((item, index) => {
        const card = document.createElement("div");
        card.className = "card mb-2 shadow-sm";
        card.innerHTML = `
            <div class="card-body">
                <h5 class="card-title">${item.description}</h5>
                <p class="card-text">
                    <strong>Amount:</strong> $${item.amount.toFixed(2)}<br>
                    <strong>Start:</strong> ${item.date}<br>
                    <strong>End:</strong> ${item.endDate || "-"}<br>
                    <strong>Frequency:</strong> ${item.frequency}
                </p>
                <div class="d-flex justify-content-between">
                    <button class="btn btn-warning btn-sm" onclick="editIncome(${index})">Edit</button>
                    <button class="btn btn-danger btn-sm" onclick="deleteIncome(${index})">Delete</button>
                </div>
            </div>`;
        incomeCardsContainer.appendChild(card);
    });
}

function renderExpensesUpdated() {
    const expenseCardsContainer = document.getElementById("expenses-cards");
    const expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
    expenseCardsContainer.innerHTML = "";
    expenses.forEach((item, index) => {
        const card = document.createElement("div");
        card.className = "card mb-2 shadow-sm";
        card.innerHTML = `
            <div class="card-body">
                <h5 class="card-title font-weight-bold">${item.description}</h5>
                <div class="row">
                    <div class="col-6"><strong>Amount:</strong> $${item.amount.toFixed(2)}</div>
                    <div class="col-6"><strong>Frequency:</strong> ${item.frequency}</div>
                </div>
                <div class="row">
                    <div class="col-6"><strong>Start:</strong> ${item.date}</div>
                    <div class="col-6"><strong>End:</strong> ${item.endDate || "-"}</div>
                </div>
                <div class="d-flex justify-content-between mt-2">
                    <button class="btn btn-warning btn-sm" onclick="editExpense(${index})">Edit</button>
                    <button class="btn btn-danger btn-sm" onclick="deleteExpense(${index})">Delete</button>
                </div>
            </div>`;
        expenseCardsContainer.appendChild(card);
    });
}
window.renderExpenses = renderExpensesUpdated;
</script><script>window.addEventListener('load', function() { renderExpenses(); renderIncomes(); });</script><script>
function editExpense(index) {
    const expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
    const item = expenses[index];
    document.getElementById("description").value = item.description;
    document.getElementById("amount").value = item.amount;
    document.getElementById("start-date").value = item.date;
    document.getElementById("end-date").value = item.endDate || '';
    document.getElementById("frequency").value = item.frequency;
    document.getElementById("edit-index").value = index;
}

function deleteExpense(index) {
    let expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
    if (confirm("Delete this expense?")) {
        expenses.splice(index, 1);
        localStorage.setItem("expenses", JSON.stringify(expenses));
        renderExpenses();
        updateChart();
    }
}

function editIncome(index) {
    const incomes = JSON.parse(localStorage.getItem("incomes") || "[]");
    const item = incomes[index];
    document.getElementById("description-income").value = item.description;
    document.getElementById("amount-income").value = item.amount;
    document.getElementById("start-date-income").value = item.date;
    document.getElementById("end-date-income").value = item.endDate || '';
    document.getElementById("frequency-income").value = item.frequency;
    document.getElementById("edit-index-income").value = index;
}

function deleteIncome(index) {
    let incomes = JSON.parse(localStorage.getItem("incomes") || "[]");
    if (confirm("Delete this income?")) {
        incomes.splice(index, 1);
        localStorage.setItem("incomes", JSON.stringify(incomes));
        renderIncomes();
        updateChart();
    }
}

window.editExpense = editExpense;</script><script>
function editExpense(index) {
    const expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
    const item = expenses[index];
    document.getElementById("description").value = item.description;
    document.getElementById("amount").value = item.amount;
    document.getElementById("start-date").value = item.date;
    document.getElementById("end-date").value = item.endDate || '';
    document.getElementById("frequency").value = item.frequency;
    document.getElementById("edit-index").value = index;
}

function deleteExpense(index) {
    let expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
    if (confirm("Delete this expense?")) {
        expenses.splice(index, 1);
        localStorage.setItem("expenses", JSON.stringify(expenses));
        renderExpenses();
        updateChart();
    }
}

function editIncome(index) {
    const incomes = JSON.parse(localStorage.getItem("incomes") || "[]");
    const item = incomes[index];
    document.getElementById("description-income").value = item.description;
    document.getElementById("amount-income").value = item.amount;
    document.getElementById("start-date-income").value = item.date;
    document.getElementById("end-date-income").value = item.endDate || '';
    document.getElementById("frequency-income").value = item.frequency;
    document.getElementById("edit-index-income").value = index;
}

function deleteIncome(index) {
    let incomes = JSON.parse(localStorage.getItem("incomes") || "[]");
    if (confirm("Delete this income?")) {
        incomes.splice(index, 1);
        localStorage.setItem("incomes", JSON.stringify(incomes));
        renderIncomes();
        updateChart();
    }
}

window.editExpense = editExpense;</script>
<!-- Expense Modal -->
<div aria-hidden="true" aria-labelledby="expenseModalLabel" class="modal fade" id="expenseModal" role="dialog" tabindex="-1">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title" id="expenseModalLabel">Add/Edit Expense</h5>
<button aria-label="Close" class="close" data-dismiss="modal" onclick="$('#expenseModal').modal('hide')" type="button">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<input id="expense-index" type="hidden"/>
<div class="form-group">
<label>Description</label>
<input class="form-control" id="expense-desc" type="text"/>
</div>
<div class="form-group">
<label>Amount</label>
<input class="form-control" id="expense-amount" type="number"/>
</div>
<div class="form-group">
<label>Start Date</label>
<input class="form-control" id="expense-start" type="date"/>
</div>
<div class="form-group">
<label>End Date (optional)</label>
<input class="form-control" id="expense-end" type="date"/>
</div>
<div class="form-group">
<label>Frequency</label>
<select class="form-control" id="expense-frequency">
<option value="once">Once</option>
<option value="weekly">Weekly</option>
<option value="monthly">Monthly</option>
<option value="yearly">Yearly</option>
</select>
</div>
</div>
<div class="modal-footer">
<button class="btn btn-secondary" onclick="$('#expenseModal').modal('hide')" type="button">Cancel</button>
<button class="btn btn-primary" onclick="saveExpense()" type="button">Save</button>
</div>
</div>
</div>
</div>
<!-- Income Modal -->
<div aria-hidden="true" aria-labelledby="incomeModalLabel" class="modal fade" id="incomeModal" role="dialog" tabindex="-1">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title" id="incomeModalLabel">Add/Edit Income</h5>
<button aria-label="Close" class="close" data-dismiss="modal" onclick="$('#incomeModal').modal('hide')" type="button">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<input id="income-index" type="hidden"/>
<div class="form-group">
<label>Description</label>
<input class="form-control" id="income-desc" type="text"/>
</div>
<div class="form-group">
<label>Amount</label>
<input class="form-control" id="income-amount" type="number"/>
</div>
<div class="form-group">
<label>Start Date</label>
<input class="form-control" id="income-start" type="date"/>
</div>
<div class="form-group">
<label>End Date (optional)</label>
<input class="form-control" id="income-end" type="date"/>
</div>
<div class="form-group">
<label>Frequency</label>
<select class="form-control" id="income-frequency">
<option value="once">Once</option>
<option value="weekly">Weekly</option>
<option value="monthly">Monthly</option>
<option value="yearly">Yearly</option>
</select>
</div>
</div>
<div class="modal-footer">
<button class="btn btn-secondary" onclick="$('#incomeModal').modal('hide')" type="button">Cancel</button>
<button class="btn btn-primary" onclick="saveIncome()" type="button">Save</button>
</div>
</div>
</div>
</div>
<script>
function saveExpense() {
    const index = document.getElementById("expense-index").value;
    const desc = document.getElementById("expense-desc").value;
    const amount = parseFloat(document.getElementById("expense-amount").value);
    const start = document.getElementById("expense-start").value;
    const end = document.getElementById("expense-end").value;
    const freq = document.getElementById("expense-frequency").value;

    if (!desc || isNaN(amount) || !start || !freq) {
        alert("Please fill out all required fields.");
        return;
    }

    let expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
    const data = { description: desc, amount, date: start, endDate: end, frequency: freq };

    if (index === "") expenses.push(data);
    else expenses[parseInt(index)] = data;

    localStorage.setItem("expenses", JSON.stringify(expenses));
    $('#expenseModal').modal('hide');
    renderExpenses();
updateChart();
    updateChart();
}

function saveIncome() {
    const index = document.getElementById("income-index").value;
    const desc = document.getElementById("income-desc").value;
    const amount = parseFloat(document.getElementById("income-amount").value);
    const start = document.getElementById("income-start").value;
    const end = document.getElementById("income-end").value;
    const freq = document.getElementById("income-frequency").value;

    if (!desc || isNaN(amount) || !start || !freq) {
        alert("Please fill out all required fields.");
        return;
    }

    let incomes = JSON.parse(localStorage.getItem("incomes") || "[]");
    const data = { description: desc, amount, date: start, endDate: end, frequency: freq };

    if (index === "") incomes.push(data);
    else incomes[parseInt(index)] = data;

    localStorage.setItem("incomes", JSON.stringify(incomes));
    $('#incomeModal').modal('hide');
    renderIncomes();
updateChart();
    updateChart();
}

function editExpense(index) {
    const expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
    const item = expenses[index];
    document.getElementById("expense-index").value = index;
    document.getElementById("expense-desc").value = item.description;
    document.getElementById("expense-amount").value = item.amount;
    document.getElementById("expense-start").value = item.date;
    document.getElementById("expense-end").value = item.endDate || '';
    document.getElementById("expense-frequency").value = item.frequency || 'once';
    $('#expenseModal').modal('show');
}

function editIncome(index) {
    const incomes = JSON.parse(localStorage.getItem("incomes") || "[]");
    const item = incomes[index];
    document.getElementById("income-index").value = index;
    document.getElementById("income-desc").value = item.description;
    document.getElementById("income-amount").value = item.amount;
    document.getElementById("income-start").value = item.date;
    document.getElementById("income-end").value = item.endDate || '';
    document.getElementById("income-frequency").value = item.frequency || "once";
    $('#incomeModal').modal('show');
}

window.editExpense = editExpense;
window.editIncome = editIncome;
window.saveExpense = saveExpense;
window.saveIncome = saveIncome;

function clearExpenseModal() {
    document.getElementById("expense-index").value = "";
    document.getElementById("expense-desc").value = "";
    document.getElementById("expense-amount").value = "";
    document.getElementById("expense-start").value = "";
    document.getElementById("expense-end").value = "";
    document.getElementById("expense-frequency").value = "once";
    $('#expenseModal').modal('show');
}
function clearIncomeModal() {
    document.getElementById("income-index").value = "";
    document.getElementById("income-desc").value = "";
    document.getElementById("income-amount").value = "";
    document.getElementById("income-start").value = "";
    document.getElementById("income-end").value = "";
    document.getElementById("income-frequency").value = "once";
    $('#incomeModal').modal('show');
}
window.clearExpenseModal = clearExpenseModal;
window.clearIncomeModal = clearIncomeModal;

window.addEventListener('load', function() {
    updateChart();
});
</script><script>
function groupAndRenderItems(type) {
    const container = document.getElementById(type + "-cards");
    const items = JSON.parse(localStorage.getItem(type + "s") || "[]");
    container.innerHTML = "";

    const grouped = { once: [], weekly: [], monthly: [], yearly: [] };
    items.sort((a, b) => new Date(a.date) - new Date(b.date));
    items.forEach(item => grouped[item.frequency].push(item));

    const freqNames = { once: "One-Time", weekly: "Weekly", monthly: "Monthly", yearly: "Yearly" };
    const today = new Date();

    for (const freq in grouped) {
        if (grouped[freq].length === 0) continue;

        let total = grouped[freq].reduce((sum, i) => sum + parseFloat(i.amount || 0), 0).toFixed(2);
        const section = document.createElement("div");
        const toggle = document.createElement("div");
        const groupId = `${type}-group-${freq}`;
        toggle.innerHTML = `<div class='bg-light p-2 mb-2 border d-flex justify-content-between align-items-center' onclick="toggleGroup('${groupId}')">
            <strong>${freqNames[freq]} (${grouped[freq].length})</strong>
            <span>Total: $${total}</span>
        </div>`;
        section.appendChild(toggle);

        const groupContent = document.createElement("div");
        groupContent.id = groupId;
        groupContent.className = "mb-3";

        grouped[freq].forEach((item, index) => {
            const card = document.createElement("div");
            card.className = "card mb-2 shadow-sm";
            let highlight = "";
            const itemDate = new Date(item.date);
            if ((itemDate - today) / (1000 * 60 * 60 * 24) <= 30) highlight = " style='background-color: #fff8dc;'";

            card.innerHTML = `<div class="card-body"${highlight}>
                <h5 class="card-title font-weight-bold">${item.description}</h5>
                <div class="row">
                    <div class="col-6"><strong>Amount:</strong> $${parseFloat(item.amount).toFixed(2)}</div>
                    <div class="col-6"><strong>Frequency:</strong> ${item.frequency}</div>
                </div>
                <div class="row">
                    <div class="col-6"><strong>Start:</strong> ${item.date}</div>
                    <div class="col-6"><strong>End:</strong> ${item.endDate || "-"}</div>
                </div>
                <div class="d-flex justify-content-end mt-2">
                    <button class="btn btn-sm btn-outline-primary mr-2" onclick="edit${capitalize(type)}(${findIndexInOriginal(type, item)})" title="Edit">&#9998;</button>
                    <button class="btn btn-sm btn-outline-danger" onclick="delete${capitalize(type)}(${findIndexInOriginal(type, item)})" title="Delete">&#128465;</button>
                </div>
            </div>`;
            groupContent.appendChild(card);
        });

        section.appendChild(groupContent);
        container.appendChild(section);
    }
}

function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
}

function findIndexInOriginal(type, item) {
    const items = JSON.parse(localStorage.getItem(type + "s") || "[]");
    return items.findIndex(x =>
        x.description === item.description &&
        x.amount == item.amount &&
        x.date === item.date &&
        x.endDate === item.endDate &&
        x.frequency === item.frequency
    );
}

function toggleGroup(id) {
    const el = document.getElementById(id);
    if (el) el.style.display = (el.style.display === "none") ? "block" : "none";
}

// Replace render functions with grouped versions
window.renderExpenses = () => groupAndRenderItems("expense");
window.renderIncomes = () => groupAndRenderItems("income");
</script><script>
window.addEventListener('load', function() {
  renderExpenses();
  renderIncomes();
});
</script><script>
function renderExpenses() {
    const expenseCardsContainer = document.getElementById("expenses-cards");
    const expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
    expenseCardsContainer.innerHTML = "";
    expenses.forEach((item, index) => {
        const card = document.createElement("div");
        card.className = "card mb-2 shadow-sm";
        card.innerHTML = `<div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <h5 class="card-title font-weight-bold" style="font-size:2rem;">${item.description}</h5>
                <div class="d-flex align-items-center">
                    <button class="btn btn-sm btn-outline-primary mr-3" onclick="editExpense(${index})" title="Edit">&#9998;</button>
                    <button class="btn btn-sm btn-outline-danger" onclick="deleteExpense(${index})" title="Delete">&#128465;</button>
                </div>
            </div>
            <div class="row">
                <div class="col-6"><strong>Amount:</strong> $${parseFloat(item.amount).toFixed(2)}</div>
                <div class="col-6"><strong>Frequency:</strong> ${item.frequency}</div>
            </div>
            <div class="row">
                <div class="col-6"><strong>Start:</strong> ${item.date}</div>
                <div class="col-6"><strong>End:</strong> ${item.endDate || "-"}</div>
            </div>
        </div>`;
        expenseCardsContainer.appendChild(card);
    });
}

function renderIncomes() {
    const incomeCardsContainer = document.getElementById("income-cards");
    const incomes = JSON.parse(localStorage.getItem("incomes") || "[]");
    incomeCardsContainer.innerHTML = "";
    incomes.forEach((item, index) => {
        const card = document.createElement("div");
        card.className = "card mb-2 shadow-sm";
        card.innerHTML = `<div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <h5 class="card-title font-weight-bold" style="font-size:2rem;">${item.description}</h5>
                <div class="d-flex align-items-center">
                    <button class="btn btn-sm btn-outline-primary mr-3" onclick="editIncome(${index})" title="Edit">&#9998;</button>
                    <button class="btn btn-sm btn-outline-danger" onclick="deleteIncome(${index})" title="Delete">&#128465;</button>
                </div>
            </div>
            <div class="row">
                <div class="col-6"><strong>Amount:</strong> $${parseFloat(item.amount).toFixed(2)}</div>
                <div class="col-6"><strong>Frequency:</strong> ${item.frequency}</div>
            </div>
            <div class="row">
                <div class="col-6"><strong>Start:</strong> ${item.date}</div>
                <div class="col-6"><strong>End:</strong> ${item.endDate || "-"}</div>
            </div>
        </div>`;
        incomeCardsContainer.appendChild(card);
    });
}

window.addEventListener('load', function() {
    renderExpenses();
    renderIncomes();
});
</script><script>window.addEventListener('load', function() { renderExpenses(); renderIncomes(); });</script><script>
function renderExpenses() {
    const expenseCardsContainer = document.getElementById("expenses-cards");
    const expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
    expenseCardsContainer.innerHTML = "";
    expenses.forEach((item, index) => {
        const card = document.createElement("div");
        card.className = "card mb-2 shadow-sm";
        card.innerHTML = `<div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <h5 class="card-title font-weight-bold" style="font-size:2rem;">${item.description}</h5>
                <div>
                    <button class="btn btn-sm btn-outline-primary mr-2" onclick="editExpense(${index})" title="Edit">&#9998;</button>
                    <button class="btn btn-sm btn-outline-danger" onclick="deleteExpense(${index})" title="Delete">&#128465;</button>
                </div>
            </div>
            <div class="row">
                <div class="col-6"><strong>Amount:</strong> $${parseFloat(item.amount).toFixed(2)}</div>
                <div class="col-6"><strong>Frequency:</strong> ${item.frequency}</div>
            </div>
            <div class="row">
                <div class="col-6"><strong>Start:</strong> ${item.date}</div>
                <div class="col-6"><strong>End:</strong> ${item.endDate || "-"}</div>
            </div>
        </div>`;
        expenseCardsContainer.appendChild(card);
    });
}

function renderIncomes() {
    const incomeCardsContainer = document.getElementById("income-cards");
    const incomes = JSON.parse(localStorage.getItem("incomes") || "[]");
    incomeCardsContainer.innerHTML = "";
    incomes.forEach((item, index) => {
        const card = document.createElement("div");
        card.className = "card mb-2 shadow-sm";
        card.innerHTML = `<div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <h5 class="card-title font-weight-bold" style="font-size:2rem;">${item.description}</h5>
                <div>
                    <button class="btn btn-sm btn-outline-primary mr-2" onclick="editIncome(${index})" title="Edit">&#9998;</button>
                    <button class="btn btn-sm btn-outline-danger" onclick="deleteIncome(${index})" title="Delete">&#128465;</button>
                </div>
            </div>
            <div class="row">
                <div class="col-6"><strong>Amount:</strong> $${parseFloat(item.amount).toFixed(2)}</div>
                <div class="col-6"><strong>Frequency:</strong> ${item.frequency}</div>
            </div>
            <div class="row">
                <div class="col-6"><strong>Start:</strong> ${item.date}</div>
                <div class="col-6"><strong>End:</strong> ${item.endDate || "-"}</div>
            </div>
        </div>`;
        incomeCardsContainer.appendChild(card);
    });
}

// Ensure the page load triggers these newly defined functions
window.addEventListener('load', function() {
    renderExpenses();
    renderIncomes();
});
</script></body>
</html>